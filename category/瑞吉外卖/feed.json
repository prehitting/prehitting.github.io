{
    "version": "https://jsonfeed.org/version/1",
    "title": "不利索の鸣 • All posts by \"瑞吉外卖\" category",
    "description": "欢迎来到鸣崽的空间，这里不仅有学习，还有生活",
    "home_page_url": "https://prehitting.gitee.io",
    "items": [
        {
            "id": "https://prehitting.gitee.io/2022/05/30/%E9%A1%B9%E7%9B%AE/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96/%E9%80%9A%E7%94%A8%E7%BB%93%E6%9E%9C%E7%B1%BBR/",
            "url": "https://prehitting.gitee.io/2022/05/30/%E9%A1%B9%E7%9B%AE/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96/%E9%80%9A%E7%94%A8%E7%BB%93%E6%9E%9C%E7%B1%BBR/",
            "title": "通用结果类R",
            "date_published": "2022-05-30T00:16:57.000Z",
            "content_html": "<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 通用返回结果类</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &lt;T&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">R</span>&lt;T&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer code; <span class=\"comment\">//编码：1成功，0和其它数字为失败</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String msg; <span class=\"comment\">//错误信息</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> T data; <span class=\"comment\">//数据</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Map</span> <span class=\"variable\">map</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>(); <span class=\"comment\">//动态数据</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; R&lt;T&gt; <span class=\"title function_\">success</span><span class=\"params\">(T object)</span> &#123;</span><br><span class=\"line\">        R&lt;T&gt; r = <span class=\"keyword\">new</span> <span class=\"title class_\">R</span>&lt;T&gt;();</span><br><span class=\"line\">        r.data = object;</span><br><span class=\"line\">        r.code = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; R&lt;T&gt; <span class=\"title function_\">error</span><span class=\"params\">(String msg)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">R</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">R</span>();</span><br><span class=\"line\">        r.msg = msg;</span><br><span class=\"line\">        r.code = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R&lt;T&gt; <span class=\"title function_\">add</span><span class=\"params\">(String key, Object value)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.map.put(key, value);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "瑞吉外卖"
            ]
        },
        {
            "id": "https://prehitting.gitee.io/2022/05/30/%E9%A1%B9%E7%9B%AE/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96/mvc%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%B7%AF%E5%BE%84%E6%B3%A8%E5%86%8C/",
            "url": "https://prehitting.gitee.io/2022/05/30/%E9%A1%B9%E7%9B%AE/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96/mvc%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%B7%AF%E5%BE%84%E6%B3%A8%E5%86%8C/",
            "title": "mvc静态资源路径注册",
            "date_published": "2022-05-30T00:16:57.000Z",
            "content_html": "<p>SpringMVC 默认的静态资源路径是 static，templates</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">@Configuration</span><br><span class=\"line\">public class WebMvcConfig extends WebMvcConfigurationSupport &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void addResourceHandlers(ResourceHandlerRegistry registry) &#123;</span><br><span class=\"line\">        registry.addResourceHandler(&quot;/backend/**&quot;).addResourceLocations(&quot;classpath:/backend/&quot;);</span><br><span class=\"line\">        registry.addResourceHandler(&quot;/front/**&quot;).addResourceLocations(&quot;classpath:/front/&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "瑞吉外卖",
                "SpringMVC"
            ]
        },
        {
            "id": "https://prehitting.gitee.io/2022/05/30/%E9%A1%B9%E7%9B%AE/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96/day02-%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E8%BF%87%E6%BB%A4%E5%99%A8%E9%85%8D%E7%BD%AE/",
            "url": "https://prehitting.gitee.io/2022/05/30/%E9%A1%B9%E7%9B%AE/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96/day02-%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E8%BF%87%E6%BB%A4%E5%99%A8%E9%85%8D%E7%BD%AE/",
            "title": "day02-用户登录过滤器配置",
            "date_published": "2022-05-30T00:13:20.000Z",
            "content_html": "<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 用户登录过滤器</span></span><br><span class=\"line\"><span class=\"comment\"> * 检查用户是否已经完成登录</span></span><br><span class=\"line\"><span class=\"comment\"> * 未登录则拒绝访问部分页面</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@WebFilter(filterName = &quot;loginCheckFilter&quot;,urlPatterns = &quot;/*&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LoginCheckFilter</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Filter</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">AntPathMatcher</span> <span class=\"variable\">PATH_MATCHER</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AntPathMatcher</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doFilter</span><span class=\"params\">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class=\"keyword\">throws</span> IOException, ServletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">HttpServletRequest</span> <span class=\"variable\">request</span> <span class=\"operator\">=</span> (HttpServletRequest) servletRequest;</span><br><span class=\"line\">        <span class=\"type\">HttpServletResponse</span> <span class=\"variable\">response</span> <span class=\"operator\">=</span> (HttpServletResponse) servletResponse;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//1. 获取本次请求的URI</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">requestURI</span> <span class=\"operator\">=</span> request.getRequestURI();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;拦截到请求：&quot;</span>+requestURI);</span><br><span class=\"line\">        <span class=\"comment\">//需要放行的资源</span></span><br><span class=\"line\">        String[] urls = <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>[] &#123;</span><br><span class=\"line\">                <span class=\"string\">&quot;/employee/login&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;/employee/logout&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;/backend/**&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;/front/**&quot;</span></span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//2. 判断本次请求是否需要放行</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (check(urls,requestURI)) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;请求&quot;</span>+requestURI+<span class=\"string\">&quot;被放行&quot;</span>);</span><br><span class=\"line\">            filterChain.doFilter(request,response);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//3. 判断登录状态，若已登录则放行</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (request.getSession().getAttribute(<span class=\"string\">&quot;employee&quot;</span>)!=<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;用户已登录，用户id为：&#123;&#125;&quot;</span>,request.getSession().getAttribute(<span class=\"string\">&quot;employee&quot;</span>));</span><br><span class=\"line\">            filterChain.doFilter(request,response);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;用户未登录&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//4. 若未登录则返回登录结果，通过输出流方式向客户端页面响应数据</span></span><br><span class=\"line\">        response.getWriter().write(JSON.toJSONString(R.error(<span class=\"string\">&quot;NOTLOGIN&quot;</span>)));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 路径匹配，本次请求是否需要放行</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> urls</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> requestURI</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">check</span><span class=\"params\">(String[] urls,String requestURI)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String url : urls )&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (PATH_MATCHER.match(url, requestURI)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>需要在 SpringBoot 启动类上增加 @ServletComponentScan 注解</strong></p>\n",
            "tags": [
                "过滤器",
                "瑞吉外卖"
            ]
        }
    ]
}